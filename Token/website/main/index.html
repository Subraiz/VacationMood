<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="./main.css"/>
    <script src="./main.js"></script>
    <script src="../../node_modules/web3/dist/web3.min.js"></script>
    <title>Vacation Mood Collectible Token</title>
</head>
<body>


      <div style="background-color: red;"class="container">
        <img class="landingPage" src='../v1/landingPage.png'>
        <button id="getToken" type="button" class="btn" onclick="mint()">Buy Your Token!</button>
      </div>

      <div id="metamask">
        <div class="status noMetamask">
          <h3>Hi!</h3>
          <p>In order to obtain the token you should first download Metamask.</p>
          <p class="note">To download Metamask, head to the Chrome Web Store. Once downloaded create an account and store the seed phrase.</p>
        </div>
      </div>

      <div id="confirmation">
        <div class="status success">
          <h3>Thank you!</h3>
          <p>Woot! You successfully requested the Alice token.</p>
          <p class="note">We just sent it to your address, look at the transaction hash and download the ebook here.</p>
        </div>

        <div class="status error">
          <h3>Oops, token request failed.</h3>
          <p class="note">It looks like your request could not be processed at this time. Please try again soon.</p>
          <p class="error-message"></p>
        </div>
      </div>




      <script type="text/javascript">
        window.onload = () => {
          var contract = null;
          var abi = null;
          var contractAddress = "0x4de397226ecf480d7ea1873f7ee0295c4616cf22";
          var account = null;
          //var Web3 = require('web3');
          if (typeof web3 !== 'undefined') {
            web3 = new Web3(web3.currentProvider);
          } else {
            // set the provider you want from Web3.providers
            web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:7545"));
            web3 = new Web3(web3.currentProvider);
          }

          function loadABI() {
            return new Promise(function(resolve, reject) {
              fetch("../../build/contracts/VacationMood.json")
              .then(r => r.json())
              .then(json => {
                abi = json.abi;
                resolve(abi);
              });
            });
          }

        function getTokens() {
          var account = web3.eth.accounts[0];

          this.contract.tokenOfOwnerByIndex.call(account, 0, (err, result) => {
            if(err) {
              console.log(err);
              return;
            }

            console.log(result.valueOf());
          });
        }

        loadABI().then(a => {
            contract = web3.eth.contract(abi).at(contractAddress);
            console.log("Loaded contract...");

            getTokens();
          });
      }



      </script>


</body>
</html>
